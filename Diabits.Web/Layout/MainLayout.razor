@inherits LayoutComponentBase
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@using Diabits.Web.Features.Auth.Services
@inject AuthService AuthService
@inject NavigationManager Nav

@* Required *@
<MudThemeProvider Theme="@CustomTheme.DiabitsTheme" />
<MudPopoverProvider />

@* Needed for dialogs *@
<MudDialogProvider />

@* Needed for snackbars *@
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="1">
        <MudImage Src="assets/wordmark_white.png" Alt="Diabits wordmark" ObjectFit="ObjectFit.Contain" Class="h-100 py-2" />
        <MudSpacer />
        <MudIconButton Icon="@Icons.Material.Filled.Settings" Color="Color.Inherit" OnClick="@(() => Nav.NavigateTo("/settings"))" />
        <MudIconButton Icon="@Icons.Material.Filled.Logout" Color="Color.Inherit" OnClick="LogoutAsync" />
    </MudAppBar>
    <MudMainContent>
        @Body
    </MudMainContent>
</MudLayout>


@code {
    private async Task LogoutAsync()
    {
        await AuthService.LogoutAsync();
        Nav.NavigateTo("/login");
    }
}